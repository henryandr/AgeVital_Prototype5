# üåø AgeVital Prototype 5 (TARS 1)

**Sistema de Monitoreo Ambiental IoT con M√°quina de Estados**

---

## üìã Tabla de Contenidos

- [Descripci√≥n General](#-descripci√≥n-general)
- [Caracter√≠sticas](#-caracter√≠sticas)
- [Arquitectura del Sistema](#-arquitectura-del-sistema)
- [Requisitos](#-requisitos)
- [Estructura del Proyecto](#-estructura-del-proyecto)
- [Instalaci√≥n desde Cero](#-instalaci√≥n-desde-cero)
- [Configuraci√≥n de Hardware](#-configuraci√≥n-de-hardware)
- [Funcionamiento de la M√°quina de Estados](#-funcionamiento-de-la-m√°quina-de-estados)
- [Diagrama de Clases](#-diagrama-de-clases)
- [Gu√≠a de Uso](#-gu√≠a-de-uso)

---

## üåü Descripci√≥n General

**AgeVital Prototype 5** es un sistema embebido de monitoreo ambiental basado en ESP32 que mide **5 variables ambientales cr√≠ticas** y las env√≠a a un servidor mediante HTTP. El proyecto implementa el **Patr√≥n de Dise√±o State** para una gesti√≥n eficiente y modular de los diferentes modos de operaci√≥n.

### Variables Monitoreadas:

| Variable | Sensor | Unidad | Frecuencia |
|----------|--------|--------|------------|
| üå°Ô∏è **Temperatura** | HDC1080 | ¬∞C | 2 segundos |
| üíß **Humedad** | HDC1080 | % | 2 segundos |
| ‚òÄÔ∏è **Luz** | DFRobot B-LUX V30B | lux | 2 segundos |
| üîä **Ruido** | Sensor Anal√≥gico | dBA | 2 segundos |
| ‚è±Ô∏è **Timestamp** | millis() | ms | En cada env√≠o |

### Env√≠o de Datos:

Los datos se env√≠an cada **15 segundos** en formato JSON a un servidor **Orion Context Broker** mediante HTTP POST.

---

## ‚ú® Caracter√≠sticas

- ‚úÖ **Arquitectura Modular:** Implementaci√≥n del Patr√≥n State para separaci√≥n de responsabilidades
- ‚úÖ **Gesti√≥n Autom√°tica de Estados:** Transiciones inteligentes entre modos de operaci√≥n
- ‚úÖ **Pantalla OLED Interactiva:** 4 modos de visualizaci√≥n con apagado autom√°tico
- ‚úÖ **Modo Desarrollador:** Servidor web integrado para configuraci√≥n avanzada
- ‚úÖ **Configuraci√≥n WiFi Persistente:** Almacenamiento en EEPROM
- ‚úÖ **Filtrado de Datos:** Detecci√≥n y correcci√≥n de lecturas an√≥malas
- ‚úÖ **Reconexi√≥n Autom√°tica:** Manejo inteligente de p√©rdida de WiFi
- ‚úÖ **Bajo Consumo:** Optimizaci√≥n de recursos del ESP32

---

## üèóÔ∏è Arquitectura del Sistema

### Diagrama de Arquitectura General

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                    ESP32 (Main Controller)                  ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                                                             ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê      ‚îÇ
‚îÇ  ‚îÇ         StateMachine (Motor Principal)            ‚îÇ      ‚îÇ
‚îÇ  ‚îÇ  ‚Ä¢ Gestiona transiciones entre estados           ‚îÇ       ‚îÇ
‚îÇ  ‚îÇ  ‚Ä¢ Mantiene datos compartidos (flags, clocks)    ‚îÇ       ‚îÇ
‚îÇ  ‚îÇ  ‚Ä¢ Coordina el flujo del programa                ‚îÇ       ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò      ‚îÇ
‚îÇ         ‚îÇ                                                   ‚îÇ
‚îÇ         ‚îÇ Controla                                          ‚îÇ
‚îÇ         ‚Üì                                                   ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê       ‚îÇ
‚îÇ  ‚îÇ              Estados Concretos                   ‚îÇ       ‚îÇ
‚îÇ  ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§       ‚îÇ
‚îÇ  ‚îÇ  üîµ EstadoINICIO        (Inicializaci√≥n)         ‚îÇ       ‚îÇ
‚îÇ  ‚îÇ  üü¢ EstadoLECTURA       (Lectura de sensores)    ‚îÇ       ‚îÇ
‚îÇ  ‚îÇ  üü° EstadoENVIO         (Env√≠o HTTP)             ‚îÇ       ‚îÇ
‚îÇ  ‚îÇ  üî¥ EstadoDESARROLLADOR (Configuraci√≥n web)      ‚îÇ       ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò       ‚îÇ
‚îÇ                                                             ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ                    ‚îÇ                    ‚îÇ
         ‚Üì                    ‚Üì                    ‚Üì
    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê          ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê          ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚îÇSensores‚îÇ          ‚îÇ  WiFi   ‚îÇ          ‚îÇ OLED   ‚îÇ
    ‚îÇI2C/ADC ‚îÇ          ‚îÇ  HTTP   ‚îÇ          ‚îÇDisplay ‚îÇ
    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò          ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò          ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## üì¶ Requisitos

### Hardware

| Componente | Especificaci√≥n | Cantidad |
|------------|----------------|----------|
| Microcontrolador | ESP32 Dev Module | 1 |
| Sensor Temp/Hum | HDC1080 (I2C) | 1 |
| Sensor de Luz | DFRobot B-LUX V30B (I2C) | 1 |
| Sensor de Sonido | Micr√≥fono anal√≥gico | 1 |
| Pantalla | OLED SSD1306 128x64 (I2C) | 1 |
| Bot√≥n | Pulsador (modo pantalla) | 1 |
| Bot√≥n | Pulsador (modo desarrollador) | 1 |

### Software

- **Arduino IDE:** 1.8.19 o superior (o Arduino IDE 2.x)
- **Plataforma ESP32:** Instalada en Arduino IDE
- **Librer√≠as Arduino:**
  - Adafruit GFX Library
  - Adafruit SSD1306
  - ArduinoJson (v6.x)
  - DFRobot_B_LUX_V30B
  - HTTPClient (incluida en ESP32)
  - WiFi (incluida en ESP32)
  - WebServer (incluida en ESP32)

### Librer√≠as Personalizadas (incluidas en el proyecto)

- **ClosedCube_HDC1080:** Driver para sensor de temperatura/humedad
- **ESPaccesspoint:** Gesti√≥n de Access Point y configuraci√≥n WiFi
- **Settings:** Almacenamiento persistente en EEPROM

---

## üìÅ Estructura del Proyecto

```
AgeVital_Prototype5/
‚îÇ
‚îú‚îÄ‚îÄ libraries/                          üìö Librer√≠as Arduino personalizadas
‚îÇ   ‚îú‚îÄ‚îÄ ClosedCube_HDC1080/            ‚Üí Driver HDC1080 (I2C)
‚îÇ   ‚îú‚îÄ‚îÄ DFRobot_B_LUX_V30B/            ‚Üí Driver sensor de luz
‚îÇ   ‚îî‚îÄ‚îÄ ESPaccesspoint/                ‚Üí Gesti√≥n de Access Point y WiFi
‚îÇ       ‚îú‚îÄ‚îÄ ESPaccesspoint.h
‚îÇ       ‚îú‚îÄ‚îÄ ESPaccesspoint.cpp
‚îÇ       ‚îú‚îÄ‚îÄ Settings.h
‚îÇ       ‚îî‚îÄ‚îÄ Settings.cpp
‚îÇ
‚îî‚îÄ‚îÄ src/
    ‚îî‚îÄ‚îÄ ME_prototipo/                   üíª C√≥digo fuente principal
        ‚îú‚îÄ‚îÄ ME_prototipo.ino           ‚Üê Archivo principal (setup/loop)
        ‚îÇ
        ‚îî‚îÄ‚îÄ lib/                        ü§ñ M√°quina de Estados
            ‚îú‚îÄ‚îÄ State.h                ‚Üê Clase base abstracta
            ‚îú‚îÄ‚îÄ StateMachine.h         ‚Üê Definici√≥n de la m√°quina
            ‚îú‚îÄ‚îÄ StateMachine.cpp       ‚Üê Implementaci√≥n de la m√°quina
            ‚îî‚îÄ‚îÄ Estados.cpp            ‚Üê Todos los estados concretos
```

### Descripci√≥n de Carpetas

#### üìö `libraries/`

Contiene las **librer√≠as personalizadas** del proyecto que deben instalarse en Arduino IDE:

- **ClosedCube_HDC1080:** Librer√≠a modificada para el sensor de temperatura y humedad
- **DFRobot_B_LUX_V30B:** Librer√≠a del sensor de luz
- **ESPaccesspoint:** Librer√≠a custom que incluye:
  - Configuraci√≥n de Access Point WiFi
  - Gesti√≥n de credenciales WiFi
  - Almacenamiento persistente en EEPROM
  - **Configuraci√≥n de URL del servidor** para env√≠o de datos

> ‚ö†Ô∏è **Importante:** Estas librer√≠as est√°n incluidas en el repositorio porque contienen **modificaciones espec√≠ficas** para este proyecto (como la configuraci√≥n del servidor Orion Context Broker).

#### üíª `src/ME_prototipo/`

Contiene el c√≥digo fuente principal del proyecto:

- **`ME_prototipo.ino`:** Archivo principal de Arduino con `setup()` y `loop()`
- **`lib/`:** Implementaci√≥n de la **M√°quina de Estados**
  - `State.h` - Interfaz base para todos los estados
  - `StateMachine.h/cpp` - Motor de la m√°quina de estados
  - `Estados.cpp` - Implementaci√≥n de los 4 estados concretos

---

## üöÄ Instalaci√≥n desde Cero

Sigue esta gu√≠a paso a paso si **nunca has trabajado con ESP32 o Arduino**.

### Paso 1Ô∏è‚É£: Instalar Arduino IDE

1. Descarga **Arduino IDE** desde [https://www.arduino.cc/en/software](https://www.arduino.cc/en/software)
2. Instala la aplicaci√≥n en tu sistema operativo
3. Abre Arduino IDE

### Paso 2Ô∏è‚É£: Configurar Soporte para ESP32

1. Abre **Arduino IDE**
2. Ve a `Archivo` ‚Üí `Preferencias`
3. En **"Gestor de URLs adicionales de tarjetas"** pega esta URL:
   ```
   https://raw.githubusercontent.com/espressif/arduino-esp32/gh-pages/package_esp32_index.json
   ```
4. Click en **OK**
5. Ve a `Herramientas` ‚Üí `Placa` ‚Üí `Gestor de tarjetas...`
6. Busca **"esp32"**
7. Instala **"esp32 by Espressif Systems"** (versi√≥n 2.0.x o superior)
8. Espera a que termine la instalaci√≥n

### Paso 3Ô∏è‚É£: Instalar Librer√≠as Est√°ndar

1. Ve a `Herramientas` ‚Üí `Administrar Bibliotecas...`
2. Instala las siguientes librer√≠as **una por una**:

| Librer√≠a | Versi√≥n | Autor |
|----------|---------|-------|
| Adafruit GFX Library | √öltima | Adafruit |
| Adafruit SSD1306 | √öltima | Adafruit |
| ArduinoJson | 6.x | Benoit Blanchon |

Para instalar:
- Escribe el nombre en la barra de b√∫squeda
- Click en **Instalar**
- Espera a que termine

### Paso 4Ô∏è‚É£: Clonar el Repositorio

**Opci√≥n A: Con Git (recomendado)**

```bash
cd ~/Documentos
git clone https://github.com/henryandr/AgeVital_Prototype5.git
cd AgeVital_Prototype5
```

**Opci√≥n B: Descarga directa**

1. Ve a [https://github.com/henryandr/AgeVital_Prototype5](https://github.com/henryandr/AgeVital_Prototype5)
2. Click en el bot√≥n verde **"Code"** ‚Üí **"Download ZIP"**
3. Descomprime el archivo en `Documentos/AgeVital_Prototype5`

### Paso 5Ô∏è‚É£: Instalar Librer√≠as Personalizadas

Las librer√≠as personalizadas deben copiarse manualmente a la carpeta de Arduino:

#### En Windows:

```
Origen: AgeVital_Prototype5/libraries/*
Destino: C:\Users\TuUsuario\Documents\Arduino\libraries\
```

#### En macOS:

```
Origen: AgeVital_Prototype5/libraries/*
Destino: /Users/TuUsuario/Documents/Arduino/libraries/
```

#### En Linux:

```
Origen: AgeVital_Prototype5/libraries/*
Destino: ~/Arduino/libraries/
```

**Pasos detallados:**

1. Abre la carpeta `AgeVital_Prototype5/libraries/`
2. Copia **todas las carpetas** que encuentres:
   - `ClosedCube_HDC1080`
   - `DFRobot_B_LUX_V30B`
   - `ESPaccesspoint`
3. Pega estas carpetas en la carpeta `Arduino/libraries/` de tu usuario
4. **Cierra y vuelve a abrir Arduino IDE** para que reconozca las nuevas librer√≠as

### Paso 6Ô∏è‚É£: Abrir el Proyecto

1. En Arduino IDE, ve a `Archivo` ‚Üí `Abrir`
2. Navega a:
   ```
   AgeVital_Prototype5/src/ME_prototipo/ME_prototipo.ino
   ```
3. Click en **Abrir**

Deber√≠as ver varias pesta√±as en la parte superior:

```
[ME_prototipo] [StateMachine.cpp] [StateMachine.h] [Estados.cpp] [State.h]
```

### Paso 7Ô∏è‚É£: Configurar la Placa ESP32

1. Ve a `Herramientas` ‚Üí `Placa` ‚Üí `ESP32 Arduino` ‚Üí **ESP32 Dev Module**
2. Configura los siguientes par√°metros:

```
Herramientas ‚Üí
  ‚îú‚îÄ Upload Speed: 921600
  ‚îú‚îÄ CPU Frequency: 240MHz (WiFi/BT)
  ‚îú‚îÄ Flash Frequency: 80MHz
  ‚îú‚îÄ Flash Mode: QIO
  ‚îú‚îÄ Flash Size: 4MB (32Mb)
  ‚îú‚îÄ Partition Scheme: Default 4MB with spiffs
  ‚îú‚îÄ Core Debug Level: None
  ‚îî‚îÄ PSRAM: Disabled
```

### Paso 8Ô∏è‚É£: Conectar el ESP32

1. Conecta el ESP32 a tu computadora mediante cable USB
2. Ve a `Herramientas` ‚Üí `Puerto`
3. Selecciona el puerto COM donde est√° el ESP32:
   - **Windows:** `COM3`, `COM4`, etc.
   - **macOS:** `/dev/cu.usbserial-XXXX`
   - **Linux:** `/dev/ttyUSB0`

> üí° **Tip:** Si no aparece ning√∫n puerto, instala el driver CH340 o CP2102 seg√∫n tu placa.

### Paso 9Ô∏è‚É£: Compilar y Subir

1. Click en el bot√≥n **‚úì Verificar** (esquina superior izquierda)
2. Espera a que compile sin errores
3. Si compila correctamente, click en **‚Üí Subir**
4. Espera a que termine la carga

**Salida esperada:**

```
Sketch uses XXXXX bytes (XX%) of program storage space.
Global variables use XXXX bytes (XX%) of dynamic memory.
Hard resetting via RTS pin...
```

### Paso üîü: Configurar WiFi (Primera Vez)

Al iniciar por primera vez, el ESP32 crear√° un **Access Point**:

1. Con√©ctate a la red WiFi: **`ESP-HOTSPOT`**
2. Abre un navegador y ve a: `http://192.168.4.1`
3. Ingresa:
   - **SSID:** Nombre de tu red WiFi
   - **Contrase√±a:** Contrase√±a de tu red
   - **URL del servidor:** `http://TU_SERVIDOR:1026/v2/entities/AmbientMonitor_001/attrs`
4. Click en **Guardar**
5. El ESP32 se reiniciar√° y se conectar√° a tu WiFi

---

## üîå Configuraci√≥n de Hardware

### Diagrama de Conexiones

```
                    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                    ‚îÇ       ESP32         ‚îÇ
                    ‚îÇ   Dev Module        ‚îÇ
                    ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
                    ‚îÇ                     ‚îÇ
      HDC1080       ‚îÇ GPIO 21 (SDA) ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ I2C SDA (HDC1080, B-LUX, OLED)
      B-LUX V30B    ‚îÇ GPIO 22 (SCL) ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ I2C SCL (HDC1080, B-LUX, OLED)
      OLED SSD1306  ‚îÇ                     ‚îÇ
                    ‚îÇ GPIO 27 ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ Bot√≥n Pantalla (Pull-up interno)
                    ‚îÇ GPIO 26 ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ Bot√≥n Desarrollador (Pull-up interno)
                    ‚îÇ GPIO 35 (ADC) ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ Sensor de Sonido
                    ‚îÇ                     ‚îÇ
                    ‚îÇ 3.3V ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ VCC (todos los sensores)
                    ‚îÇ GND ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ GND (todos los sensores)
                    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### Tabla de Conexiones Detalladas

| ESP32 Pin | Funci√≥n | Dispositivo | Pin Dispositivo |
|-----------|---------|-------------|-----------------|
| **GPIO 21** | SDA (I2C) | HDC1080 | SDA |
| **GPIO 21** | SDA (I2C) | B-LUX V30B | SDA |
| **GPIO 21** | SDA (I2C) | OLED | SDA |
| **GPIO 22** | SCL (I2C) | HDC1080 | SCL |
| **GPIO 22** | SCL (I2C) | B-LUX V30B | SCL |
| **GPIO 22** | SCL (I2C) | OLED | SCL |
| **GPIO 27** | Entrada Digital | Bot√≥n Pantalla | Terminal 1 |
| **GPIO 26** | Entrada Digital | Bot√≥n Desarrollador | Terminal 1 |
| **GPIO 35** | ADC | Sensor Sonido | OUT |
| **3.3V** | Alimentaci√≥n | Todos | VCC |
| **GND** | Tierra | Todos | GND |
| **GND** | Tierra | Bot√≥n Pantalla | Terminal 2 |
| **GND** | Tierra | Bot√≥n Desarrollador | Terminal 2 |

### Direcciones I2C

| Dispositivo | Direcci√≥n I2C | Modificable |
|-------------|---------------|-------------|
| HDC1080 | `0x40` | No |
| OLED SSD1306 | `0x3C` | S√≠ (jumper) |
| B-LUX V30B | Por defecto | Depende del modelo |

### Esquema de Botones

```
     ‚îå‚îÄ‚îÄ‚îÄ‚îê
  ‚îÄ‚îÄ‚îÄ‚î§   ‚îú‚îÄ‚îÄ‚îÄ  GPIO 27 (Pull-up interno activado)
     ‚îî‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ
      GND

     ‚îå‚îÄ‚îÄ‚îÄ‚îê
  ‚îÄ‚îÄ‚îÄ‚î§   ‚îú‚îÄ‚îÄ‚îÄ  GPIO 26 (Pull-up interno activado)
     ‚îî‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ
      GND
```

**Configuraci√≥n:**
- Resistencias pull-up **internas** activadas en el c√≥digo
- Bot√≥n presionado = `LOW`
- Bot√≥n suelto = `HIGH`

---

## ü§ñ Funcionamiento de la M√°quina de Estados

La m√°quina de estados gestiona el flujo del programa de forma modular y eficiente.

### Estados del Sistema

| Estado | S√≠mbolo | Responsabilidad | Duraci√≥n |
|--------|---------|-----------------|----------|
| **INICIO** | üîµ | Inicializaci√≥n del sistema | ~100ms |
| **LECTURA** | üü¢ | Lectura de sensores y actualizaci√≥n de pantalla | Continuo |
| **ENVIO** | üü° | Env√≠o de datos al servidor HTTP | ~2 segundos |
| **DESARROLLADOR** | üî¥ | Configuraci√≥n web y diagn√≥sticos | Hasta salir manualmente |

### Diagrama de Transici√≥n de Estados

```
                        [POWER ON]
                            ‚îÇ
                            ‚Üì
                    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                    ‚îÇ  üîµ INICIO    ‚îÇ
                    ‚îÇ (First Scan)  ‚îÇ
                    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                            ‚îÇ
                            ‚îÇ Autom√°tico
                            ‚îÇ (~100ms)
                            ‚Üì
        ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
        ‚îÇ          üü¢ LECTURA                   ‚îÇ
        ‚îÇ  ‚Ä¢ Lee sensores cada 2s               ‚îÇ
        ‚îÇ  ‚Ä¢ Actualiza pantalla                 ‚îÇ
        ‚îÇ  ‚Ä¢ Verifica tiempo de env√≠o           ‚îÇ
        ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                ‚îÇ           ‚Üë
                ‚îÇ           ‚îÇ
                ‚îÇ Timer     ‚îÇ Autom√°tico
                ‚îÇ 15s       ‚îÇ tras env√≠o
                ‚îÇ           ‚îÇ
                ‚Üì           ‚îÇ
        ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
        ‚îÇ          üü° ENVIO                 ‚îÇ
        ‚îÇ  ‚Ä¢ Verifica WiFi                  ‚îÇ
        ‚îÇ  ‚Ä¢ Env√≠a datos por HTTP           ‚îÇ
        ‚îÇ  ‚Ä¢ Programa siguiente env√≠o       ‚îÇ
        ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò


        [Desde cualquier estado]
                ‚îÇ
                ‚îÇ Bot√≥n DEV presionado
                ‚îÇ (GPIO 26 LOW)
                ‚Üì
        ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
        ‚îÇ    üî¥ DESARROLLADOR                ‚îÇ
        ‚îÇ  ‚Ä¢ Inicia servidor web             ‚îÇ
        ‚îÇ  ‚Ä¢ Muestra informaci√≥n t√©cnica     ‚îÇ
        ‚îÇ  ‚Ä¢ Permite configuraci√≥n           ‚îÇ
        ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                ‚îÇ
                ‚îÇ Bot√≥n DEV soltado
                ‚îÇ (GPIO 26 HIGH)
                ‚Üì
        Regresa a üîµ INICIO
```

### Condiciones de Transici√≥n

| Estado Origen | Estado Destino | Condici√≥n | Descripci√≥n |
|---------------|----------------|-----------|-------------|
| üîµ INICIO | üü¢ LECTURA | Autom√°tico | Tras inicializaci√≥n exitosa |
| üîµ INICIO | üî¥ DESARROLLADOR | `flags.dev == true` | Si se detect√≥ bot√≥n presionado al inicio |
| üü¢ LECTURA | üü° ENVIO | `millis() >= proximo_envio` | Cada 15 segundos |
| üü¢ LECTURA | üî¥ DESARROLLADOR | `flags.dev == true` | Presi√≥n del bot√≥n DEV |
| üü° ENVIO | üü¢ LECTURA | Autom√°tico | Tras env√≠o (exitoso o fallido) |
| üü° ENVIO | üî¥ DESARROLLADOR | `flags.dev == true` | Presi√≥n del bot√≥n DEV |
| üî¥ DESARROLLADOR | üîµ INICIO | `GPIO 26 == HIGH` | Al soltar el bot√≥n DEV |

---

## üìä Diagrama de Clases

### UML de la Arquitectura

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ              <<abstract>>                        ‚îÇ
‚îÇ                 State                            ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ # statemachine: StateMachine*                    ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ + setStateMachine(StateMachine*): void           ‚îÇ
‚îÇ + onEnter(): void                                ‚îÇ
‚îÇ + execute(): void                                ‚îÇ
‚îÇ + onExit(): void                                 ‚îÇ
‚îÇ + getName(): const char*                         ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                        ‚ñ≥
                        ‚îÇ
                        ‚îÇ hereda
        ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
        ‚îÇ               ‚îÇ               ‚îÇ              ‚îÇ
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇEstadoINICIO  ‚îÇ ‚îÇEstadoLECTURA‚îÇ ‚îÇEstadoENVIO ‚îÇ ‚îÇEstadoDESARRO- ‚îÇ
‚îÇ              ‚îÇ ‚îÇ             ‚îÇ ‚îÇ            ‚îÇ ‚îÇ  LLADOR       ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§ ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§ ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§ ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ-firstRun:bool‚îÇ ‚îÇ             ‚îÇ ‚îÇ-ServerName ‚îÇ ‚îÇ-primera_vez   ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§ ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§ ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§ ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ+onEnter()    ‚îÇ ‚îÇ+onEnter()   ‚îÇ ‚îÇ+onEnter()  ‚îÇ ‚îÇ+onEnter()     ‚îÇ
‚îÇ+execute()    ‚îÇ ‚îÇ+execute()   ‚îÇ ‚îÇ+execute()  ‚îÇ ‚îÇ+execute()     ‚îÇ
‚îÇ+onExit()     ‚îÇ ‚îÇ+onExit()    ‚îÇ ‚îÇ+onExit()   ‚îÇ ‚îÇ+onExit()      ‚îÇ
‚îÇ+getName()    ‚îÇ ‚îÇ+getName()   ‚îÇ ‚îÇ+getName()  ‚îÇ ‚îÇ+getName()     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ              StateMachine                        ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ - currentState: State*                           ‚îÇ
‚îÇ - previousState: State*                          ‚îÇ
‚îÇ + flags: Flags                                   ‚îÇ
‚îÇ + clocks: Clocks                                 ‚îÇ
‚îÇ + sensors: SensorData                            ‚îÇ
‚îÇ + settings: Config                               ‚îÇ
‚îÇ + screenMode: int                                ‚îÇ
‚îÇ + isDisplayOn: bool                              ‚îÇ
‚îÇ + needsUpdate: bool                              ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ + StateMachine()                                 ‚îÇ
‚îÇ + ~StateMachine()                                ‚îÇ
‚îÇ + begin(State*): void                            ‚îÇ
‚îÇ + update(): void                                 ‚îÇ
‚îÇ + ChangeState(State*): void                      ‚îÇ
‚îÇ + setSettings(ulong, ulong): void                ‚îÇ
‚îÇ + getCurrentState(): State*                      ‚îÇ
‚îÇ + getCurrentStateName(): const char*             ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ
         ‚îÇ usa
         ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ              Estructuras de Datos                ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ Flags         { inicio, lectura, envio, dev }    ‚îÇ
‚îÇ Clocks        { tiempo_actual, proximo_envio }   ‚îÇ
‚îÇ SensorData    { temp, hum, lux, dbValue }        ‚îÇ
‚îÇ Config        { INTERVALO_LECTURA, ENVIO }       ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## üìñ Gu√≠a de Uso

### Iniciar el Sistema

1. **Alimenta el ESP32** mediante USB o fuente externa (5V)
2. La pantalla OLED mostrar√°:
   ```
   Estado: INICIO
   Iniciando...
   ```
3. Tras ~100ms pasar√° autom√°ticamente a:
   ```
   Estado: LECTURA
   Temp: 24.5 C
   Hum: 60.2 %
   Lux: 450.0 lux
   Ruido: 45.3 dBA
   ```

### Cambiar Modo de Pantalla

Presiona el **bot√≥n de pantalla** (GPIO 27) para alternar entre 4 modos:

1. **Modo 0 - Todos los Sensores**
2. **Modo 1 - Temperatura y Humedad**
3. **Modo 2 - Luz**
4. **Modo 3 - Ruido**

### Entrar a Modo Desarrollador

1. **Mant√©n presionado** el bot√≥n de desarrollador (GPIO 26)
2. En tu navegador, ve a la IP mostrada en pantalla
3. Para salir: Suelta el bot√≥n de desarrollador (sigue en desarrollo -- puede cambiar)

---
